---
title: 使用vscode ssh连接linux虚拟机
date: 2019-08-27T09:57:31.278Z
description: 使用vscode连接Linux虚拟机
tags:
  - Linux
  - VSCode
  - VirtualBox
categories:
  - Linux
toc: true
mathjax: false
---
vscode在最新的稳定版中增加了ssh的支持，我们就可以使用ssh拓展连接远程主机进行开发。同样的，如果我们在windows环境下，用ssh来连接linux虚拟机进行windows下的linux无缝开发，也是可行的。

## 配置虚拟机（服务端）

虚拟机的安装我就不详细说了，网上有很多这方面的资料。这里假设我们已经安装好了一个linux虚拟机。我用的是virtualbox，我们需要对虚拟机的网络进行一些配置。

在virtualbox中选中要设置的虚拟机，点击设置，点击网络，如果在安装虚拟机的过程中没有进行特殊的设置，这时的连接方式应该是“网络地址转换(NAT)”，就用这个设置就行。展开下面的“高级”选项，点击“端口转发”，新建一个转发规则，名称就叫做“ssh”，协议用“TCP”，主机IP和子系统IP可以空着不写，主机端口随便填一个没有被占用的端口即可，我这里用的是2201，同样的子系统端口也随便填一个没有被占用的端口即可，我这里用的是22。

这样我们的服务端就设置好了，相当于我们在自己的本机上有了一个“服务器”。接下来就用客户端进行登录。

## 使用客户端ssh连接虚拟机

win10已经内置了openssh，所以直接可以在命令行中用ssh命令登录。在虚拟机中使用Linux图形界面着实卡，所以我在安装的时候就没有安装图形界面，启动时就可以使用无界面启动。

打开cmd，或是poweshell等等任何你喜欢的终端，输入命令：

```
ssh user@localhost -p 2201
```

`user` 是你要登录的用户，`localhost` 就表示这是一个本地环境，**不用**像网上的一些教程所写的，要在虚拟机中查看ip之类的操作。关键在于`-p` 参数后面的端口要正确，这里用的是前面设置的**主机端口**，回车后就会提示输入密码，就可以正确登录了。

当然如果觉得在命令行中操作起来比较麻烦，尤其是windows环境下的命令行确实不怎么友好，也可以使用专业的ssh客户端进行登录，比如putty、mobaxterm。

## 使用vscode连接虚拟机

vscode 通过插件提供了ssh客户端的功能。需要的是最新版的vscode和remote-ssh插件。安装后，vscode的侧边栏会多出一个这样的图标。

之后还需要进行一些配置。点击CONNECTIONS左边的设置，会出现几个配置文件，编辑第一个就行，这是默认的用户配置。配置也很简单，原本只有三行，但是要注意的是如果主机端口不是默认的 `22` 的话，需要在下面添加一行`Port`，端口填写刚才设置的**主机端口**。

```
Host name
	HostName localhost
	User username
	Port 2201
```

之后点击窗口左下角的这个图标，选择`Remote-SSH: connect to host`，在弹出的菜单中选择刚才写在配置文件中的host，vscode自动进行配置。等待一小会儿，配置完成！尽情在windows中享受无缝Linux环境的开发体验的吧。

